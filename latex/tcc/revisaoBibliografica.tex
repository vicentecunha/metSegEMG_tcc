\section{Sinais de Eletromiografia}
% ---

Sinais de EMG podem ser adquiridos por eletrodos posicionados na superfície da pele (eletrodo não invasivo) ou por agulhas introduzidas no tecido muscular (eletrodo invasivo). Sinais de EMG são compostos por potenciais de ação de fibras musculares organizadas em unidades funcionais chamadas de "unidades motoras" (MU - \emph{Motor Unit}) (DE LUCA \emph{et al}. 2006). Uma unidade motora é composta por um neurônio motor e as fibras musculares que ele inerva, e é a entidade fundamental que controla a ativação de músculos estriados (BUCHTAL and SCHMALBRUCH, 1980). A soma algébrica dos potenciais de ação de todas as fibras de uma unidade motora é chamada de "potencial de ação da unidade motora", ou em inglês, MUAP (\emph{Motor Unit Action Potential}) (ALMEIDA, 1997). A Figura \ref{fig_MUAP_comp} apresenta a composição de uma MUAP a partir da soma dos potenciais das fibras de uma unidade motora.

\begin{figure}[htb]
	\caption{\label{fig_MUAP_comp}Soma de potenciais de ação das \emph{n} fibras de uma unidade motora, formando uma MUAP \emph{h(t)}.}
	\begin{center}
	    \includegraphics[width=0.75\linewidth]{./img/MUAP_oneMU.png}
	\end{center}
	\legend{Fonte: adaptado de BASMAJIAN \& DE LUCA, 1985}
\end{figure}

Dependendo do método utilizado para aquisição de EMG, é comum a captura da contribuição de mais de uma unidade motora no mesmo canal. A influência de uma unidade motora no sinal adquirido depende principalmente da distância das fibras musculares ao ponto de aquisição (HAMMARBERG and STERNAD, 2002). Sinais de EMG de longa duração são constituídos por sequências temporais de MUAPs, também conhecidas como MUAPTs (\emph{MUAP Trains}). A Figura \ref{fig_MUAP_trains} exemplifica MUAPTs de diferentes MUs que somam-se para formar um sinal de EMG de longa duração.

\begin{figure}[htb]
	\caption{\label{fig_MUAP_trains}MUAPTs de diferentes MUs somam-se para compor o sinal adquirido por um canal de EMG.}
	\begin{center}
	    \includegraphics[width=0.75\linewidth]{./img/MUAP_trains.jpg}
	\end{center}
	\legend{Fonte: adaptado de KLINE \& DE LUCA, 2014}
\end{figure}

% ---
\section{Métodos de Segmentação}
% ---

Esta seção descreve os métodos de segmentação que foram utilizados como base teórica para os métodos desenvolvidos neste trabalho. Nota-se que nomes utilizados para variáveis e constantes (por exemplo `$r$', `$T$', etc.) foram determinados pelo autor deste estudo, não necessariamente sendo estes utilizados nos métodos originais. Para as definições dos métodos 3 e 4 (MTD3 e MTD4) são utilizados os termos BEP (\emph{beginning extraction point}, ponto inicial de um segmento) e EEP (\emph{ending extraction point}, ponto final de um segmento), também utilizados em (PATTICHIS \emph{et al}. 1995).
	
% ---
\subsection{Método 1 - método iterativo utilizando \emph{thresholding} para detecção de centros de segmentos de comprimento constante (MTD1)}
% ---

Este é o método iterativo de segmentação utilizado em (CHAUVET \emph{et al}. 2001). As definições da Tabela \ref{tab_mtd1params} serão utilizados para descrever este método.
\begin{table}[htb]
\IBGEtab{%
	\caption{Parâmetros utilizados para definir MTD1.}%
	\label{tab_mtd1params}
}{%
	\begin{tabular}{ccc}
	\toprule
	Nome & Descrição \\
	\midrule \midrule
	$x$ & Sinal a ser segmentado \\
	\midrule
	$L$ & Comprimento total do sinal a ser segmentado \\
	\midrule
	$l$ & Comprimento desejado para os segmentos \\
	\midrule
	$T_k$ & Valor de \emph{threshold} para a iteração $k$ \\
	\midrule 
	$q$ & Fração de $T_{k-1}$ para determinação de $T_k$ \\
	\midrule 
	$N_{k}$ & Número total de candidatos para centros de segmentos identificados na iteração $k$ \\
	\midrule 
	$r_k$ & Razão entre número de candidatos identificados na iteração $k$ e o comprimento total do sinal \\
	\midrule 
	$r_{target}$ & Razão mínima esperada para $r_k$, utilizada para determinar o final do método \\
	\bottomrule
\end{tabular}%
}{%
}
\end{table}

Inicialmente, determina-se o valor de \emph{threshold} $T_0$ equivalente ao máximo absoluto do sinal a ser segmentado $x$ (Equação (\ref{eq:mtd1t0})). O valor $T_k$ é atualizado em cada iteração $k$ como sendo uma fração $q$ de $T_{k-1}$ (Equação (\ref{eq:mtd1tk})). No trabalho de (CHAUVET \emph{et al}. 2001), este valor $q$ foi empiricamente determinado em 90\%.

\begin{equation}
\label{eq:mtd1t0}
  T_0 = max(x)
\end{equation}

\begin{equation}
\label{eq:mtd1tk}
  T_k = q \times T_{k-1}
\end{equation}

Pontos do sinal acima do valor de $T_k$ são possíveis candidatos para centros de segmentos. Caso exista mais de um possível candidato em uma vizinhança bilateral de $l$ amostras do sinal, apenas o ponto de maior amplitude nesta vizinhança é considerado.

Para determinar o final do método, avalia-se a razão $r_k$ entre a quantidade identificada de candidatos $N_{k}$ e o comprimento total do sinal $L$ (Equação (\ref{eq:mtd1rk})). Caso $r_k$ seja menor que um valor predeterminado $r_{target}$, calcula-se $T_{k+1}$ para realização da próxima iteração (Equação (\ref{eq:mtd1tk})). Caso $r_k$ seja maior ou igual ao valor predeterminado $r_{target}$, encerra-se o método e os segmentos são tomados como janelas de sinal de comprimento $l$, centradas nos candidatos identificados na última iteração.

\begin{equation}
\label{eq:mtd1rk}
  r_k = \frac{N_{k}}{L} 
\end{equation}

O método de segmentação MTD1 é representado pelo fluxograma da Figura \ref{fig_mtd1flux}.

\begin{figure}[htb]
	\caption{\label{fig_mtd1flux}Fluxograma representativo do MTD1.}
	\begin{center}
		\begin{tikzpicture}[node distance = 2cm, auto]
			% Place nodes
			\node [block] (init) {INÍCIO\\ \vspace{\onelineskip} $k = 0$\\$T_0 = max(x)$};
			\node [block, below of=init, node distance=3cm] (identify) {Identificar candidatos a centros de segmentos};
			\node [decision, below of=identify] (decide) {$\frac{N_c}{L} >= r_{target}$};
			\node [block, left of=identify, node distance=6cm] (update) {$k++$\\$T_k = q \times T_{k-1}$};
			\node [block, below of=decide, node distance=4cm] (stop) {Segmentos de comprimento $l$ centrados nos candidatos identificados\\ \vspace{\onelineskip} FIM};
			
			% Draw edges
			\path [line] (init) -- (identify);
			\path [line] (identify) -- (decide);
			\path [line] (decide) -| node [near start] {NÃO} (update);
			\path [line] (update) |- (identify);
			\path [line] (decide) -- node {SIM}(stop);
		\end{tikzpicture}
	\end{center}
\end{figure}

%Para ilustrar o MTD1, a Figura \ref{fig:mtd1example} apresenta uma implementação em trecho de sinal de EMG retirado da base de dados Ninapro, com fração $q$ de 90\% (isto é, $T_k = 0.9\times T_{k-1}$) e segmentos de comprimento $l$ de 401 amostras.
% 
%\begin{figure}
%\centering
%\includegraphics[width=\linewidth]{./img/mtd1example.eps}
%\caption{Ilustração da implementação do MTD1, com $q = 0.9$ e $l = 401$. Do autor.}
%\label{fig:mtd1example}
%\end{figure}
 
% ---
\subsection{Método 2 - método não iterativo utilizando \emph{thresholding} para detecção de centros de segmentos de comprimento constante (MTD2)}
% ---

Este é o método de segmentação utilizado em (KATSIS \emph{et al}. 2006). As definições da Tabela \ref{tab:mtd2params} serão utilizados para descrever este método. Primeiramente, calcula-se o valor de \emph{threshold} $T$ a partir da média aritmética, do comprimento $L$ e do valor máximo do sinal a ser segmentado $x$. No trabalho de (KATSIS \emph{et al}. 2006), a relação utilizada para cálculo de $T$ é obtido pelo fluxograma da Figura \ref{fig_mtd2flux}.

\begin{table}[htb]
\IBGEtab{%
	\caption{Parâmetros utilizados para definir MTD2.}%
	\label{tab:mtd2params}
}{%
	\begin{tabular}{ccc}
	\toprule
	Nome & Descrição \\
	\midrule \midrule
	$x$ & Sinal a ser segmentado \\
	\midrule
	$L$ & Comprimento total do sinal a ser segmentado \\
	\midrule
	$l$ & Comprimento desejado para os segmentos \\
	\midrule
	$T$ & Valor de \emph{threshold} \\
	\bottomrule
\end{tabular}%
}{%
}
\end{table}

\begin{figure}[htb]
	\caption{\label{fig_mtd2flux} TODO: FLUXOGRAMA PARA CÁLCULO DE THRESHOLD NO MTD2}
	\begin{center}
		\begin{tikzpicture}[node distance = 2cm, auto]
			% Place nodes
			\node [block] (init) {INÍCIO\\ \vspace{\onelineskip} $k = 0$\\$T_0 = max(x)$};
			\node [block, below of=init, node distance=3cm] (identify) {Identificar candidatos a centros de segmentos};
			\node [decision, below of=identify] (decide) {$\frac{N_c}{L} >= r_{target}$};
			\node [block, left of=identify, node distance=6cm] (update) {$k++$\\$T_k = q \times T_{k-1}$};
			\node [block, below of=decide, node distance=4cm] (stop) {Segmentos de comprimento $l$ centrados nos candidatos identificados\\ \vspace{\onelineskip} FIM};
			
			% Draw edges
			\path [line] (init) -- (identify);
			\path [line] (identify) -- (decide);
			\path [line] (decide) -| node [near start] {NÃO} (update);
			\path [line] (update) |- (identify);
			\path [line] (decide) -- node {SIM}(stop);
		\end{tikzpicture}
	\end{center}
\end{figure}

%\begin{equation}
%\label{eq:thKatsisCond}
%	if\left(max(x) > \frac{30}{L}\sum_{i=1}^{L}|x_i|\right); then: T = \frac{5}{L}\sum_{i=1}^{L}|x_i|; else: T = \frac{max(x)}{5}
%\end{equation}

De forma similar ao MTD1, os pontos do sinal que tiverem valor acima de $T$ são considerados possíveis candidatos para centros de segmentos. Para os possíveis candidatos que estiverem afastados de uma distância inferior a $l$, apenas o candidato de maior amplitude é considerado. Em (KATSIS \emph{et al}. 2006) utilizou-se comprimento $l$ de 121 amostras.

%A Figura \ref{fig:mtd1example} serve para ilustrar o MTD2, apresentando uma implementação em trecho de sinal de EMG retirado da base de dados Ninapro, com segmentos de comprimento $l$ de 401 amostras. O valor de \emph{threshold} T para este exemplo é calculado como $T = \frac{max(x_i)}{5}$, já que o máximo absoluto do sinal é menor que trinta vezes a média do sinal.
%
%\begin{figure}
%\centering
%\includegraphics[width=\linewidth]{./img/mtd2example.eps}
%\caption{Ilustração da implementação do MTD2, com $l = 401$. Do autor.}
%\label{fig:mtd2example}
%\end{figure}

% ---
\subsection{Método 3 - método com janela deslizante para detecção de BEP e EEP de segmentos utilizando variação total (MTD3)}
% ---

	Este é o método de segmentação utilizado em (GUT and MOSCHYTZ, 2000). As definições da Tabela \ref{tab:mtd3params} serão utilizados para descrever este método.
	
\begin{table}[htb]
\IBGEtab{%
	\caption{Parâmetros utilizados para definir MTD3.}%
	\label{tab:mtd3params}
}{%
	\begin{tabular}{ccc}
	\toprule
	Nome & Descrição \\
	\midrule \midrule
	$x$ & Sinal a ser segmentado \\
	\midrule
	$W$ & Comprimento da janela deslizante utilizada pelo método \\
	\midrule
	$w_0$ & Número da amostra mais a esquerda da janela. Determina a posição instantânea da janela \\
	\midrule
	$\beta$ & Declividade média do sinal $x$ contido na janela deslizante \\
	\midrule
	$B$ & Valor limite para declividade média que determina ponto inicial de um segmento\\
	\midrule
	$\gamma$ & Variação total do sinal $x$ contido na janela deslizante \\
	\midrule
	$C$ & Valor limite para variação total que determina ponto final de um segmento\\
	\bottomrule
\end{tabular}%
}{%
}
\end{table}

Uma janela deslizante de comprimento $W$ percorre o sinal da esquerda para a direita. Caso a declividade média $\beta$ do trecho de sinal contido pela janela, calculado pela Equação (\ref{eq:decMedia}), exceda um limite $B$, o ponto mais à esquerda da janela $w_0$ determina a BEP de um segmento.

\begin{equation}
\label{eq:decMedia}
	\beta = \frac{1}{W}\sum_{i=w_0+1}^{W}(x_i - x_{i-1})
\end{equation}

O EEP do correspondente segmento é então obtido como o ponto mais à direita da janela ($w_0 + W - 1$) quando a variação total $\gamma$, dado pela Equação (\ref{eq:varTotal}), do trecho de sinal contido pela janela for menor que um limite $C$.

\begin{equation}
\label{eq:varTotal}
	\gamma = \sum_{i=w_0+1}^{W}(x_i - x_{i-1})
\end{equation}

%\begin{figure}
%\centering
%\includegraphics[width=\linewidth]{./img/mtd3ex.png}
%\caption{Ilustração da implementação do MTD3, com $W = 100$. Do autor.}
%\label{fig:mtd3example}
%\end{figure}

% ---
\subsection{Método 4 - método com janela deslizante utilizando \emph{thresholding} para detecção de BEP e EEP de segmentos  (MTD4)}
% ---

Este é o método de segmentação utilizado em (PACHITTIS \emph{et al}. 1995). As definições da Tabela \ref{tab:mtd4params} serão utilizados para descrever este método.

\begin{table}[htb]
\IBGEtab{%
	\caption{Parâmetros utilizados para definir MTD4.}%
	\label{tab:mtd4params}
}{%
	\begin{tabular}{ccc}
	\toprule
	Nome & Descrição \\
	\midrule \midrule
	$x$ & Sinal a ser segmentado \\
	\midrule
	$W$ & Comprimento da janela deslizante utilizada pelo método \\
	\midrule
	$T$ & Valor de \emph{threshold} \\
	\bottomrule
\end{tabular}%
}{%
}
\end{table}

Primeiramente, a janela deslizante de comprimento $W$ percorre o sinal da direita para a esquerda. Os BEPs dos segmentos são os primeiros pontos (com exceção do final do sinal $x$) nas quais, com a janela situada à esquerda do ponto, o sinal contido pela janela permanece abaixo do valor de threshold $T$.

As EEPs são identificadas de forma similar, com a janela percorrendo o sinal da esquerda para a direita. Os EEPs dos segmentos são os primeiros pontos nas quais, com a janela situada à direita do ponto (com exceção do ínicio do sinal $x$), o sinal contido pela janela permanece abaixo do valor de threshold $T$.

No trabalho de (PACHITTIS \emph{et al}. 1995), utilizou-se janelas de comprimento $W$ correspondente a 3 $ms$ de aquisição e \emph{threshold} $T$ de $\pm$ 40 $\mu V$ (o sinal de EMG segmentado não era retificado).

%\begin{figure}
%\centering
%\includegraphics[width=\linewidth]{./img/mtd4ex.png}
%\caption{Ilustração da implementação do MTD4, com $W = 100$ e $T = 0,5$. Do autor.}
%\label{fig:mtd4example}
%\end{figure}

% ---
\section{Redes Neurais Artificias}
% ---

	TODO: REVISÃO SOBRE REDES NEURAIS

% ---
\section{Base de Dados Utilizadas}
% ---
% ---
\subsection{Base de Dados Ninapro}
% ---
% ---
\subsection{Base de Dados do IEE}
% ---